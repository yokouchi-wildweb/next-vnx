# ã‚¦ã‚©ãƒ¬ãƒƒãƒˆæ©Ÿèƒ½ã®è¨­è¨ˆæ–¹é‡ã¨é‹ç”¨ã‚¬ã‚¤ãƒ‰

> **ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ç§»è¡Œã•ã‚Œã¾ã—ãŸã€‚**
>
> è©³ç´°ãªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ä»¥ä¸‹ã‚’å‚ç…§ã—ã¦ãã ã•ã„ï¼š
>
> **ğŸ‘‰ [src/features/core/wallet/README.md](../../src/features/core/wallet/README.md)**

---

## æ¦‚è¦

è¤‡æ•°ç¨®é¡ã®ã‚¢ãƒ—ãƒªå†…ãƒªã‚½ãƒ¼ã‚¹ï¼ˆãƒã‚¤ãƒ³ãƒˆã€ã‚³ã‚¤ãƒ³ç­‰ï¼‰ã‚’å…±é€šã®ä»•çµ„ã¿ã§ç®¡ç†ã™ã‚‹ã‚¦ã‚©ãƒ¬ãƒƒãƒˆæ©Ÿèƒ½ã€‚

### ä¸»ãªç‰¹å¾´

| é …ç›® | å†…å®¹ |
|------|------|
| **ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹æˆ** | `wallets`ï¼ˆæ®‹é«˜ï¼‰+ `wallet_histories`ï¼ˆå±¥æ­´ï¼‰ |
| **é€šè²¨ç¨®åˆ¥** | `regular_point` / `temporary_point` / `regular_coin` |
| **æ®‹é«˜ç®¡ç†** | `balance` - `locked_balance` = åˆ©ç”¨å¯èƒ½æ®‹é«˜ |
| **äºˆç´„ãƒ•ãƒ­ãƒ¼** | `reserveBalance` â†’ `consumeReservedBalance` |
| **ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³** | å¤–éƒ¨ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã¸ã®çµ±åˆå¯¾å¿œ |
| **å±¥æ­´è¿½è·¡** | `request_batch_id` / `meta` ã«ã‚ˆã‚‹è©³ç´°ãªè¿½è·¡ |

### åŸºæœ¬æ“ä½œ

```typescript
import { walletService } from "@/features/core/wallet/services/server/walletService";

// æ®‹é«˜èª¿æ•´
await walletService.adjustBalance({
  userId, walletType: "regular_point",
  changeMethod: "INCREMENT", amount: 1000,
  sourceType: "admin_action",
});

// äºˆç´„â†’ç¢ºå®šãƒ•ãƒ­ãƒ¼
await walletService.reserveBalance({ userId, walletType, amount }, tx);
await walletService.consumeReservedBalance({ userId, walletType, amount, sourceType }, tx);
```

---

## é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- **[Wallet ãƒ‰ãƒ¡ã‚¤ãƒ³ README](../../src/features/core/wallet/README.md)** - è©³ç´°ãªAPIãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã€å‹å®šç¾©ã€å®Ÿè£…ä¾‹
- **[ã‚³ã‚¤ãƒ³è³¼å…¥æ™‚ã®æ±ºæ¸ˆãƒ•ãƒ­ãƒ¼](./ã‚³ã‚¤ãƒ³è³¼å…¥æ™‚ã®æ±ºæ¸ˆãƒ•ãƒ­ãƒ¼ã¨å¤–éƒ¨æ±ºæ¸ˆé€£æºã«é–¢ã™ã‚‹å‡¦ç†æ–¹é‡.md)** - å¤–éƒ¨æ±ºæ¸ˆé€£æº
